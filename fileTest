@PostMapping("/login")
public ResponseEntity<String> loginUser(@RequestBody UserRegistrationRequest request) {
    User user = userService.getUserByUsername(request.getUsername());
    if (user != null) {
        if (PasswordUtil.checkPassword(request.getPassword(), user.getSalt(), user.getPassword())) {
            String token = tokenService.generateToken(request.getUsername());
            if (token != null) {
                return ResponseEntity.ok(token);
            } else {
                return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body("Failed to generate token.");
            }
        } else {
            return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body("Invalid username or password.");
        }
    } else {
        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body("User not found.");
    }
}
